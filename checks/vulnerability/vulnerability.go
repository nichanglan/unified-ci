package vulnerability

import (
	"github.com/tengattack/unified-ci/checks/vulnerability/common"
	"github.com/tengattack/unified-ci/checks/vulnerability/riki"
	"github.com/tengattack/unified-ci/config"
)

// VulScanner interface
type VulScanner interface {
	CheckPackages(lang common.Language, pkgFilePath string) (bool, error)
	Query(lang common.Language) ([]common.Data, error)
	WaitForQuery()

	// context
	SetCommitID(commitID string)
	SetContext(context string)
}

// NewScanner creates new vulnerability scanner
func NewScanner(appName string, conf config.SectionVulnerability) VulScanner {
	return &riki.Scanner{
		AppName: conf.AppNamePrefix + appName,
		AppFrom: conf.AppFrom,
	}
}
